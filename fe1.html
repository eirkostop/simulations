<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Φύλλο εργασίας 1</title>
  <link rel="stylesheet" type="text/css" href="simulations.css">
  <link rel="stylesheet" href="fonts/BPtypewrite.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  <style>
    .measurement {
      position: absolute;
      left: 35%;
      transform: translate(-50%, -50%);
      color: #008982;
      font-size: 0.9em;
    }
    #sum {
      position: absolute;
      left: 35%;
      top: 87%;
      transform: translate(-50%, -50%);
      color: #008982
    }
    #average {
      position: absolute;
      left: 78%;
      top: 47%;
      transform: translate(-50%, -50%);
      color: #008982
    }
  </style>
</head>
<body>
      <div class="half">
        <span style="font-weight:bold">Φύλλο εργασίας 1</span>
        <hr style="height:2px;border-width:0;background-color:#ccc">
      </div>
    <div class="half">
      <span>© Περί ΦυσιQuiz</span>
      <hr style="height:2px;border-width:0;background-color:#ccc;">
    </div>
    <div class="half">
      <p>Μετακίνησε το χάρακα για να μετρήσεις το μήκος του θρανίου με ακρίβεια χιλιοστού (π.χ. 119.7cm).
      </p>
      <p>Μέτρηση: <input id="measurement" type="number" name="measurement" placeholder="π.χ. 119.7" step="0.1" min="0.1" max="999999999">cm.
        <br><i class="fa fa-check myCanvas-button" style="color:#333" onclick="writeMeasurement();" title="Καταχώρηση μέτρησης"></i>
        <i class="fa fa-times myCanvas-button" style="color:#333" onclick="clearMeasurement();" title="Ακύρωση μέτρησης"></i>
        <i class="fas fa-undo myCanvas-button" style="color:#333" onclick="reset();" title="Επαναφορά"></i>
        <i class="fa fa-calculator myCanvas-button" style="color:#333" onclick="calculate();" title="Υπολόγισε τη μέση τιμή"></i>
        <i id="hide-button" class="fa fa-eye-slash myCanvas-button" style="color:#333" onclick="hideDIV('experimentDIV');" title="Κρύψε το θρανίο"></i>
      </p>
      <div class="imageContainer">
        <img src="fe1.png" alt=" Φύλλο εργασίας 1" style="width:100%;">
        <p class="measurement" id="1" style="top:15%"></p>
        <p class="measurement" id="2" style="top:22.2%"></p>
        <p class="measurement" id="3" style="top:29.4%"></p>
        <p class="measurement" id="4" style="top:36.6%"></p>
        <p class="measurement" id="5" style="top:43.8%"></p>
        <p class="measurement" id="6" style="top:51.0%"></p>
        <p class="measurement" id="7" style="top:58.2%"></p>
        <p class="measurement" id="8" style="top:65.4%"></p>
        <p class="measurement" id="9" style="top:72.6%"></p>
        <p class="measurement" id="10" style="top:79.8%"></p>
        <p id="sum"></p>
        <p id="average"></p>
      </div>
    </div>
    <div id="experimentDIV" class="half">
      <canvas id="experiment" style="width:100%" width="698" height="701"></canvas>
    </div>&nbsp;
  <p id="demo"></p>
  <script type="text/javascript" src="simulations.js"></script>
  <script>
    var c = document.getElementById('experiment');
    var ctx = c.getContext("2d");
    var xmeasurements = [];

    c.addEventListener('mousedown', mouseDown, false);
    window.addEventListener('mouseup', mouseUp, false);
    c.addEventListener('touchstart', touchStart, false);
    c.addEventListener('touchmove', touchMove, false);
resizeCanvas('experiment',996,1000);
    window.addEventListener('resize', resizeCanvas('experiment',996,1000), false);
      resizeFonts();
    window.addEventListener('resize', resizeFonts, false);
  drawEverything();
    window.addEventListener('resize', drawEverything, false);


    function writeMeasurement() {
      var measurement = Number(document.getElementById("measurement").value).toFixed(1);
      if (xmeasurements.length < 11 && measurement < 1000000000 && measurement > 0) {
        xmeasurements.push(measurement);
        document.getElementById(xmeasurements.length).innerHTML = xmeasurements[xmeasurements.length - 1];
      }
    }

    function clearMeasurement() {
      if (xmeasurements.length < 11 && xmeasurements.length > 0) {
        document.getElementById(xmeasurements.length).innerHTML = "";
        xmeasurements.pop();
      }
    }

    function reset() {
      for (i = 0; i < xmeasurements.length; i++) {
        document.getElementById(i + 1).innerHTML = "";
      }
      document.getElementById("sum").innerHTML = "";
      document.getElementById("average").innerHTML = "";
      xmeasurements = [];
    }

    function calculate() {
      var xsum = 0,
        n = 0;
      for (i = 0; i < xmeasurements.length; i++) {
        xsum += Number(xmeasurements[i]);
        n++
      }
      document.getElementById("sum").innerHTML = xsum.toFixed(1);
      document.getElementById("average").innerHTML = (xsum / n).toFixed(2);
    }

    function drawEverything() {
      ctx.save();
      drawGlass();
      ctx.restore();
      drawDesk();
      drawRuler();
      ctx.rect(376, 8, 31, 25);
      ctx.moveTo(376, 32);
      ctx.lineTo(17, 120);
      ctx.moveTo(407, 33);
      ctx.lineTo(481, 121);
      ctx.stroke();
    }

    function touchStart(event) {
      pointerX = (event.targetTouches[0].pageX - c.offsetLeft) / scale;
      pointerY = (event.targetTouches[0].pageY - c.offsetTop) / scale;
      event.preventDefault();
      pointerX0 = pointerX;
      pointerY0 = pointerY;
      c.addEventListener('touchmove', touchMove, false);
    }

    function touchMove(event) {
      event.preventDefault();
      pointerX = (event.targetTouches[0].pageX - c.offsetLeft) / scale;
      pointerY = (event.targetTouches[0].pageY - c.offsetTop) / scale;
      distanceX = pointerX - pointerX0;
      distanceY = pointerY - pointerY0;
      if (pointerX0 < xr + 460 && pointerX0 > xr && pointerY0 > yr && pointerY0 < yr + 20) {
        xr = xr + distanceX;
        yr = yr + distanceY;
      }
      if (pointerY0 > 15 * yr && pointerY0 < 15 * (yr + 20)) {
        xr = xr + distanceX / 15;
        yr = yr + distanceY / 15;
      }
      pointerX0 = pointerX;
      pointerY0 = pointerY;
      drawEverything();
    }

    function mouseDown(event) {
      pointerX = (event.pageX - c.offsetLeft) / scale;
      pointerY = (event.pageY - c.offsetTop) / scale;
      event.preventDefault();
      pointerX0 = pointerX;
      pointerY0 = pointerY;
      c.addEventListener('mousemove', moveRuler, false);
    }

    function moveRuler(event) {
      pointerX = (event.pageX - c.offsetLeft) / scale;
      pointerY = (event.pageY - c.offsetTop) / scale;
      event.preventDefault();
      distanceX = pointerX - pointerX0;
      distanceY = pointerY - pointerY0;
      if (pointerX0 < xr + 460 && pointerX0 > xr && pointerY0 > yr && pointerY0 < yr + 20) {
        xr = xr + distanceX;
        yr = yr + distanceY;
      }
      if (pointerY0 > 15 * yr && pointerY0 < 15 * (yr + 20)) {
        xr = xr + distanceX / 15;
        yr = yr + distanceY / 15;
      }
      pointerX0 = pointerX;
      pointerY0 = pointerY;
      ctx.clearRect(0, 0, 500, 500);
      drawEverything();
    }

    function mouseUp(event) {
      event.preventDefault();
      c.removeEventListener('mousemove', moveRuler, false);
    }

    function drawDesk() {
      drawRect(38, 10, 360, 102,5, 'experiment');
      ctx.fillStyle = "#CF912E";
      ctx.fill();
      drawRect(40, 10, 358, 100,5, 'experiment');

      ctx.fillStyle = "#D2E8D7";
      ctx.fill();

    }

    function drawRuler() {
      drawRect(xr, yr, 460, 20,5, 'experiment');
      drawMajorGridlines(xr, yr);
    }
    //Draw gridlines
    function drawMajorGridlines(xr, yr) {
      ctx.beginPath();
      ctx.lineWidth = 0.2;
      ctx.strokeStyle = "#333";
      for (j = 0; j < 31; j++) {
        ctx.moveTo(xr + 5 + 15 * j, yr);
        ctx.lineTo(xr + 5 + 15 * j, yr + 5);
      }
      ctx.stroke();
      ctx.beginPath();
      ctx.font = "6px BPTypewrite";
      ctx.fillStyle = "#333";
      for (j = 0; j < 15; j++) {
        ctx.fillText(j * 10, xr + 3 + 30 * j, yr + 10);
        ctx.fill();
      }

    }

    function drawGridlines(xr, yr) {
      ctx.beginPath();
      ctx.fillStyle = "#333";
      ctx.lineWidth = 0.05;
      ctx.strokeStyle = "#333";
      for (j = 0; j < 151; j++) {
        ctx.moveTo(xr + 5 + 3 * j, yr);
        ctx.lineTo(xr + 5 + 3 * j, yr + 3);
      }
      for (j = 0; j < 301; j++) {
        ctx.moveTo(xr + 5 + 1.5 * j, yr);
        ctx.lineTo(xr + 5 + 1.5 * j, yr + 2);
      }
      ctx.stroke();
    }

    function drawMinorGridlines(xr, yr) {
      ctx.beginPath();
      ctx.fillStyle = "#333";
      ctx.lineWidth = 0.01;
      ctx.strokeStyle = "#333";
      for (j = 0; j < 1501; j++) {
        ctx.moveTo(xr + 5 + 0.3 * j, yr);
        ctx.lineTo(xr + 5 + 0.3 * j, yr + 1);
      }
      ctx.stroke();
    }

    function drawGlass() {
      ctx.beginPath();
      ctx.scale(15, 15);
      ctx.rect(376 - 375, 8, 31, 25);
      ctx.lineWidth = 0.05;
      ctx.stroke();
      ctx.clip();
      drawRect(-335, 10, 358, 100, 5,'experiment');
      ctx.fillStyle = "#D2E8D7";
      ctx.fill();
      drawRect(xr - 375, yr, 460, 20, 5,'experiment');
      drawMajorGridlines(xr - 375, yr);
      drawGridlines(xr - 375, yr);
      drawMinorGridlines(xr - 375, yr);
      ctx.scale(1 / 15, 1 / 15);
      ctx.restore();
    }
  </script>
</body>

</html>
